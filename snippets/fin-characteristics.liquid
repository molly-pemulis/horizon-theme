{%- comment -%}
  Fin Characteristics Visualization
  Renders Form, Function & Feel chart for fins that have this metaobject data.

  Usage: {% render 'fin-characteristics', product: product %}

  Only displays if product has custom.fin_characteristics metaobject reference.
  Created: 2026-02-03
{%- endcomment -%}

{%- assign fin = product.metafields.custom.fin_characteristics.value -%}

{%- if fin -%}
<div class="fin-characteristics">
  <details class="fin-characteristics__dropdown">
    <summary class="fin-characteristics__summary">
      <strong>FORM, FUNCTION & FEEL</strong>
      <span class="fin-characteristics__icon">
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3 4.5L6 7.5L9 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </span>
    </summary>

    <div class="fin-characteristics__content">
      <div class="fin-characteristics__chart">
        <h3 class="fin-characteristics__title">{{ product.title }}</h3>

        {%- comment -%} Rake Bar {%- endcomment -%}
        <div class="fin-characteristics__bar-group">
          <div class="fin-characteristics__bar">
            <div class="fin-characteristics__marker" style="left: {{ fin.rake.value | default: 50 }}%;"></div>
          </div>
          <div class="fin-characteristics__labels">
            <span class="fin-characteristics__label-left">
              <span class="fin-characteristics__label-primary">Upright</span> Tight Turns
            </span>
            <span class="fin-characteristics__label-right">
              <span class="fin-characteristics__label-primary">Raked</span> Drawn-Out Turns
            </span>
          </div>
        </div>

        {%- comment -%} Area Bar {%- endcomment -%}
        <div class="fin-characteristics__bar-group">
          <div class="fin-characteristics__bar">
            <div class="fin-characteristics__marker" style="left: {{ fin.area.value | default: 50 }}%;"></div>
          </div>
          <div class="fin-characteristics__labels">
            <span class="fin-characteristics__label-left">
              <span class="fin-characteristics__label-primary">Less Area</span> Loose
            </span>
            <span class="fin-characteristics__label-right">
              <span class="fin-characteristics__label-primary">More Area</span> Stable
            </span>
          </div>
        </div>

        {%- comment -%} Speed Bar {%- endcomment -%}
        <div class="fin-characteristics__bar-group">
          <div class="fin-characteristics__bar">
            <div class="fin-characteristics__marker" style="left: {{ fin.speed.value | default: 50 }}%;"></div>
          </div>
          <div class="fin-characteristics__labels">
            <span class="fin-characteristics__label-left">
              <span class="fin-characteristics__label-primary">Speed Control</span>
            </span>
            <span class="fin-characteristics__label-right">
              <span class="fin-characteristics__label-primary">Speed Generating</span> Drive
            </span>
          </div>
        </div>

        {%- comment -%} Flex Bar {%- endcomment -%}
        <div class="fin-characteristics__bar-group">
          <div class="fin-characteristics__bar">
            <div class="fin-characteristics__marker" style="left: {{ fin.flex.value | default: 50 }}%;"></div>
          </div>
          <div class="fin-characteristics__labels">
            <span class="fin-characteristics__label-left">
              <span class="fin-characteristics__label-primary">Less Flex</span> Responsive
            </span>
            <span class="fin-characteristics__label-right">
              <span class="fin-characteristics__label-primary">More Flex</span> Projection
            </span>
          </div>
        </div>
      </div>

      {%- comment -%} Text descriptions {%- endcomment -%}
      <div class="fin-characteristics__descriptions">
        {%- if fin.form_text.value != blank -%}
          <div class="fin-characteristics__description">
            <span class="fin-characteristics__description-label">Form |</span>
            {{ fin.form_text.value }}
          </div>
        {%- endif -%}

        {%- if fin.function_text.value != blank -%}
          <div class="fin-characteristics__description">
            <span class="fin-characteristics__description-label">Function |</span>
            {{ fin.function_text.value }}
          </div>
        {%- endif -%}

        {%- if fin.feel_text.value != blank -%}
          <div class="fin-characteristics__description">
            <span class="fin-characteristics__description-label">Feel |</span>
            {{ fin.feel_text.value }}
          </div>
        {%- endif -%}

        {%- if fin.overall_text.value != blank -%}
          <div class="fin-characteristics__description">
            <span class="fin-characteristics__description-label">Overall |</span>
            {{ fin.overall_text.value }}
          </div>
        {%- endif -%}
      </div>
    </div>
  </details>
</div>

<style>
  .fin-characteristics {
    margin: 1.5rem 0;
  }

  .fin-characteristics__dropdown {
    border: 1px solid var(--color-border, #e5e5e5);
  }

  .fin-characteristics__summary {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    cursor: pointer;
    list-style: none;
    background: var(--color-background, #fff);
  }

  .fin-characteristics__summary::-webkit-details-marker {
    display: none;
  }

  .fin-characteristics__icon {
    transition: transform 0.2s ease;
  }

  .fin-characteristics__dropdown[open] .fin-characteristics__icon {
    transform: rotate(180deg);
  }

  .fin-characteristics__content {
    padding: 1rem;
    border-top: 1px solid var(--color-border, #e5e5e5);
  }

  .fin-characteristics__chart {
    margin-bottom: 1.5rem;
  }

  .fin-characteristics__title {
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 1rem;
  }

  .fin-characteristics__bar-group {
    margin-bottom: 0.75rem;
  }

  .fin-characteristics__bar {
    position: relative;
    height: 12px;
    border: 1px solid #898989;
    background: transparent;
  }

  .fin-characteristics__marker {
    position: absolute;
    top: 0;
    width: 5px;
    height: 100%;
    background: #A82E2D;
    transform: translateX(-50%);
  }

  .fin-characteristics__labels {
    display: flex;
    justify-content: space-between;
    margin-top: 0.25rem;
    font-size: 0.75rem;
    color: #898989;
  }

  .fin-characteristics__label-primary {
    color: #39394a;
    font-weight: 500;
  }

  .fin-characteristics__descriptions {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .fin-characteristics__description {
    font-size: 0.875rem;
    line-height: 1.4;
  }

  .fin-characteristics__description-label {
    font-weight: 700;
    text-transform: uppercase;
    margin-right: 0.25rem;
  }
</style>
{%- endif -%}

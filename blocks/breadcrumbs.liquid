{%- comment -%}
  Breadcrumbs block for product pages
  Shows: Home / Collection / Product
  Includes structured data for SEO
{%- endcomment -%}

{%- liquid
  assign product = closest.product
  assign home_title = 'Home'
  assign divider = ' / '
-%}

{%- if product != blank -%}
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": {{ home_title | json }},
          "item": {{ shop.url | append: routes.root_url | json }}
        }
        {%- if collection -%}
          ,{
            "@type": "ListItem",
            "position": 2,
            "name": {{ collection.title | json }},
            "item": {{ shop.url | append: collection.url | json }}
          }
          ,{
            "@type": "ListItem",
            "position": 3,
            "name": {{ product.title | json }},
            "item": {{ shop.url | append: product.url | json }}
          }
        {%- else -%}
          ,{
            "@type": "ListItem",
            "position": 2,
            "name": {{ product.title | json }},
            "item": {{ shop.url | append: product.url | json }}
          }
        {%- endif -%}
      ]
    }
  </script>

  <nav class="breadcrumbs" aria-label="Breadcrumb" {{ block.shopify_attributes }}>
    <a href="{{ routes.root_url }}">{{ home_title }}</a>
    {%- if collection -%}
      {{ divider }}<a href="{{ collection.url }}">{{ collection.title }}</a>
    {%- endif -%}
    {{ divider }}<span aria-current="page">{{ product.title }}</span>
  </nav>
{%- endif -%}

{% stylesheet %}
  .breadcrumbs {
    font-size: var(--font-size-sm);
    color: rgb(var(--color-foreground-rgb) / 0.6);
    padding-block-start: var(--padding-xs);
    padding-block-end: var(--padding-sm);
  }
  .breadcrumbs a {
    color: inherit;
    text-decoration: none;
  }
  .breadcrumbs a:hover {
    color: var(--color-foreground);
    text-decoration: underline;
  }
  .breadcrumbs span[aria-current] {
    color: var(--color-foreground);
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Breadcrumbs",
  "tag": null,
  "settings": [],
  "presets": [
    {
      "name": "Breadcrumbs",
      "category": "t:categories.product"
    }
  ]
}
{% endschema %}
